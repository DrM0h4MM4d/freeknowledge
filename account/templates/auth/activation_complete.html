{% load crispy_forms_tags %}
{% load static %}

<!DOCTYPE html>
<html lang="fa">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>اتمام ثبت نام</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="{% static 'assets/vendors/mdi/css/materialdesignicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/vendors/css/vendor.bundle.base.css' %}">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static 'assets/css/rtl.css' %}">
    <!-- End layout styles -->
  </head>

  
  <body class="rtl text-right">
    <div class="container-scroller">
      <div class="container-fluid page-body-wrapper full-page-wrapper">
        <div class="row w-100 m-0">
          <div class="content-wrapper full-page-wrapper d-flex align-items-center auth login-bg">
            <div class="card col-lg-4 mx-auto">
              <div class="card-body px-5 py-5">
                <h3 class="text-right card-title text-left mb-3">ثبت نام</h3>

                <form method="POST">{% csrf_token %}
                  <div class="form-group">
                    {{form|crispy}}
                  </div>
                  <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-block enter-btn">ثبت نام</button>
                </div>
                  <p class="sign-up text-center">اکانت دارید؟<a href="#">وارد شوید</a></p>
                  <p class="terms">با ساخت اکانت شما  <a href="#"> قوانین و ضوابط</a> را قبول کردید </p>
                </form>
              </div>
            </div>
          </div>
          <!-- content-wrapper ends -->
        </div>
        <!-- row ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="{% static 'assets/vendors/js/vendor.bundle.base.js' %}"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="{% static 'assets/js/off-canvas.js' %}"></script>
    <script src="{% static 'assets/js/hoverable-collapse.js' %}"></script>
    <script src="{% static 'assets/js/misc.js' %}"></script>
    <script src="{% static 'assets/js/settings.js' %}"></script>
    <script src="{% static 'assets/js/todolist.js' %}"></script>
    <!-- endinject -->

<script>

$(document).ready(function () {
      $('#id_password_confirm').keyup(function () {
          $.ajax({
              data: {"password_confirm": $(this).serialize(),"raw_password": $("#id_raw_password").serialize()}, // get the form data
              url: "{% url 'account:validator-ps' %}",
              // on success
              success: function (response) {
                
                  if (response.not_match == true) {
                    if ($("#id_password_confirm_error").length == 0){
                      $('#id_password_confirm').removeClass('is-valid').addClass('is-invalid');
                      $('#id_password_confirm').after('<div class="invalid-feedback d-block" id="id_password_confirm_error">پسورد ها مشابه نیستتند!</div>')
                  }
                }
                  else if (response.match == true) {
                      $('#id_password_confirm').removeClass('is-invalid').addClass('is-valid');
                      $('#id_password_confirm_error').remove();
                  }

              },
              // on error
              error: function (response) {
                  console.log(response.responseJSON.errors)
              }
          });

          return false;
      });
    })
      
    </script>
    
    </body>
    </html>